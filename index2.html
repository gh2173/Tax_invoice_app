<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ë§¤ì…ì†¡ì¥ ì²˜ë¦¬ - ERP RPA ëŒ€ì‹œë³´ë“œ</title>
  <style>
    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background-image: url('https://www.transparenttextures.com/patterns/paper-fibers.png');
      background-color: #f9fcff;
      padding: 40px;
      color: #2c3e50;
      transition: background-color 0.3s ease;
      margin: 0;
    }
    .container {
      max-width: 1440px;
      margin: auto;
    }
    .section {
      margin-bottom: 30px;
      padding: 24px;
      background: #ffffff;
      border-radius: 16px;
      box-shadow: 0 4px 10px rgba(0, 0, 0, 0.08);
      transition: box-shadow 0.2s ease-in-out, transform 0.2s;
    }
    .section:hover {
      box-shadow: 0 8px 20px rgba(0, 0, 0, 0.12);
      transform: translateY(-2px);
    }
    .input-group {
      margin-top: 20px;
      padding: 15px;
      border: 1px solid #ddd;
      border-radius: 5px;
      background-color: #f9f9f9;
    }
    .input-group h3 {
      margin-top: 0;
      margin-bottom: 15px;
      color: #333;
    }
    .form-row {
      display: flex;
      align-items: center;
      gap: 15px;
      margin-bottom: 15px;
      flex-wrap: wrap;
    }
    .form-row label {
      min-width: 120px;
      font-weight: bold;
      color: #333;
    }
    .form-row input, .form-row select {
      padding: 8px 12px;
      border: 1px solid #ccc;
      border-radius: 4px;
      min-width: 200px;
    }
    .form-row input:focus, .form-row select:focus {
      border-color: #2980b9;
      outline: none;
      box-shadow: 0 0 5px rgba(41, 128, 185, 0.4);
    }
    .button-group {
      margin-top: 20px;
      display: flex;
      gap: 10px;
      flex-wrap: wrap;
    }
    .button-group button {
      padding: 10px 20px;
      border: none;
      border-radius: 6px;
      cursor: pointer;
      font-weight: bold;
      transition: all 0.3s ease;
    }
    .btn-primary {
      background-color: #2980b9;
      color: white;
    }
    .btn-primary:hover {
      background-color: #1c6692;
    }
    .btn-success {
      background-color: #27ae60;
      color: white;
    }
    .btn-success:hover {
      background-color: #1e8449;
    }
    .btn-secondary {
      background-color: #7f8c8d;
      color: white;
    }
    .btn-secondary:hover {
      background-color: #5d6d6e;
    }
    .file-upload-area {
      border: 2px dashed #bdc3c7;
      border-radius: 8px;
      padding: 40px;
      text-align: center;
      background-color: #f8f9fa;
      margin: 20px 0;
      transition: all 0.3s ease;
    }
    .file-upload-area:hover {
      border-color: #2980b9;
      background-color: #e3f2fd;
    }
    .file-upload-area.dragover {
      border-color: #2980b9;
      background-color: #e3f2fd;
    }
    .upload-icon {
      font-size: 48px;
      color: #7f8c8d;
      margin-bottom: 15px;
    }
    .upload-text {
      font-size: 16px;
      color: #555;
      margin-bottom: 10px;
    }
    .upload-hint {
      font-size: 14px;
      color: #999;
    }
    .file-list {
      margin-top: 20px;
    }
    .file-item {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 10px 15px;
      border: 1px solid #e0e0e0;
      border-radius: 6px;
      margin-bottom: 8px;
      background: white;
    }
    .file-info {
      display: flex;
      align-items: center;
      gap: 10px;
    }
    .file-icon {
      font-size: 20px;
    }
    .file-name {
      font-weight: 500;
    }
    .file-size {
      color: #666;
      font-size: 12px;
    }
    .file-actions {
      display: flex;
      gap: 8px;
    }
    .file-actions button {
      padding: 4px 8px;
      border: none;
      border-radius: 4px;
      cursor: pointer;
      font-size: 12px;
    }
    .btn-remove {
      background-color: #e74c3c;
      color: white;
    }
    .btn-remove:hover {
      background-color: #c0392b;
    }
    .status-indicator {
      padding: 4px 8px;
      border-radius: 12px;
      font-size: 11px;
      font-weight: bold;
    }
    .status-pending {
      background: #f39c12;
      color: white;
    }
    .status-processing {
      background: #3498db;
      color: white;
    }
    .status-completed {
      background: #27ae60;
      color: white;
    }
    .status-error {
      background: #e74c3c;
      color: white;
    }
    .progress-section {
      margin-top: 30px;
    }
    .progress-bar {
      width: 100%;
      height: 8px;
      background-color: #ecf0f1;
      border-radius: 4px;
      overflow: hidden;
      margin-top: 10px;
    }
    .progress-fill {
      height: 100%;
      background-color: #2980b9;
      width: 0%;
      transition: width 0.3s ease;
    }
    .progress-text {
      margin-top: 10px;
      font-size: 14px;
      color: #666;
    }

    /* ì‚¬ì´ë“œë°” ë„¤ë¹„ê²Œì´ì…˜ ìŠ¤íƒ€ì¼ */
    .sidebar {
      position: fixed;
      left: 0;
      top: 0;
      width: 250px;
      height: 100vh;
      background: #ffffff;
      box-shadow: 2px 0 10px rgba(0, 0, 0, 0.1);
      z-index: 999;
      padding: 20px 0;
      transition: all 0.3s ease;
    }    .sidebar-header {
      padding: 0 20px 30px;
      border-bottom: 1px solid #e0e0e0;
      margin-bottom: 30px;
      display: flex;
      flex-direction: column;
      align-items: center;
    }    .sidebar-logo {
      width: 99.45%;
      aspect-ratio: 1;
      margin-bottom: 15px;
      border-radius: 12px;
      object-fit: cover;
    }    .sidebar-title {
      font-size: 18px;
      font-weight: bold;
      color: #2c3e50;
      margin: 0;
    }

    .sidebar-subtitle {
      font-size: 11px;
      color: #7f8c8d;
      margin-top: 8px;
      font-weight: 400;
      text-align: center;
      opacity: 0.8;
    }

    .sidebar-nav {
      padding: 0 10px;
    }

    .nav-item {
      display: block;
      padding: 15px 20px;
      margin-bottom: 5px;
      border-radius: 8px;
      text-decoration: none;
      color: #666;
      font-weight: 500;
      transition: all 0.3s ease;
      cursor: pointer;
    }

    .nav-item:hover {
      background: #f0f5ff;
      color: #2980b9;
      text-decoration: none;
    }

    .nav-item.active {
      background: #2980b9;
      color: white;
    }

    .nav-item.active:hover {
      background: #1c6692;
    }

    .nav-icon {
      margin-right: 12px;
      font-size: 16px;
    }

    /* ë©”ì¸ ì»¨í…ì¸  ì˜ì—­ ì¡°ì • */
    .main-content {
      margin-left: 250px;
      transition: margin-left 0.3s ease;
    }    /* ìŠ¤í¬ë¦° ìº¡ì²˜ ë²„íŠ¼ ìŠ¤íƒ€ì¼ */
    .screen-capture-btn {
      position: fixed;
      top: 20px;
      right: 80px; /* ë‹¤í¬ëª¨ë“œ ë²„íŠ¼ ì™¼ìª½ì— ìœ„ì¹˜ */
      background: #27ae60;
      color: white;
      border: none;
      border-radius: 50%;
      width: 50px;
      height: 50px;
      font-size: 20px;
      cursor: pointer;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
      transition: all 0.3s ease;
      z-index: 1001;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .screen-capture-btn:hover {
      background: #219a52;
      transform: scale(1.1);
      box-shadow: 0 6px 16px rgba(0, 0, 0, 0.2);
    }

    .screen-capture-btn:active {
      transform: scale(0.95);
    }

    /* ë‹¤í¬ëª¨ë“œ í† ê¸€ ë²„íŠ¼ ìŠ¤íƒ€ì¼ */
    .dark-mode-toggle {
      position: fixed;
      top: 20px;
      right: 20px;
      background: #2980b9;
      color: white;
      border: none;
      border-radius: 50%;
      width: 50px;
      height: 50px;
      font-size: 20px;
      cursor: pointer;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
      transition: all 0.3s ease;
      z-index: 1001;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .dark-mode-toggle:hover {
      background: #1c6692;
      transform: scale(1.1);
      box-shadow: 0 6px 16px rgba(0, 0, 0, 0.2);
    }

    /* ë‹¤í¬ëª¨ë“œ ìŠ¤íƒ€ì¼ */
    body.dark-mode {
      background-color: #1a1a1a;
      background-image: none;
      color: #e0e0e0;
    }

    body.dark-mode .section {
      background: #2d2d2d;
      color: #e0e0e0;
      border: 1px solid #404040;
    }

    body.dark-mode .input-group {
      background-color: #3a3a3a;
      border: 1px solid #555;
    }

    body.dark-mode .input-group h3,
    body.dark-mode .form-row label,
    body.dark-mode h2,
    body.dark-mode h3 {
      color: #e0e0e0 !important;
    }

    body.dark-mode .form-row input,
    body.dark-mode .form-row select {
      background: #404040;
      color: #e0e0e0;
      border: 1px solid #555;
    }

    body.dark-mode .form-row input:focus,
    body.dark-mode .form-row select:focus {
      border-color: #4a9eff;
      box-shadow: 0 0 5px rgba(74, 158, 255, 0.4);
    }

    body.dark-mode .file-upload-area {
      background-color: #404040;
      border-color: #666;
      color: #e0e0e0;
    }

    body.dark-mode .file-upload-area:hover {
      border-color: #4a9eff;
      background-color: #4a4a4a;
    }

    body.dark-mode .file-item {
      background: #404040;
      border-color: #555;
      color: #e0e0e0;
    }

    body.dark-mode .upload-text {
      color: #b0b0b0;
    }

    body.dark-mode .upload-hint {
      color: #888;
    }

    body.dark-mode .progress-bar {
      background-color: #404040;
    }

    body.dark-mode .progress-text {
      color: #b0b0b0;
    }

    /* ì‚¬ì´ë“œë°” ë‹¤í¬ëª¨ë“œ ìŠ¤íƒ€ì¼ */
    body.dark-mode .sidebar {
      background: #2d2d2d;
      box-shadow: 2px 0 10px rgba(0, 0, 0, 0.3);
    }

    body.dark-mode .sidebar-header {
      border-bottom: 1px solid #404040;
    }    body.dark-mode .sidebar-title {
      color: #e0e0e0;
    }

    body.dark-mode .sidebar-subtitle {
      color: #95a5a6;
    }

    body.dark-mode .nav-item {
      color: #b0b0b0;
    }

    body.dark-mode .nav-item:hover {
      background: #404040;
      color: #4a9eff;
    }

    body.dark-mode .nav-item.active {
      background: #4a9eff;
      color: white;
    }

    body.dark-mode .nav-item.active:hover {
      background: #357abd;
    }    body.dark-mode .dark-mode-toggle {
      background: #f39c12;
    }

    body.dark-mode .dark-mode-toggle:hover {
      background: #e67e22;
    }

    /* ë‹¤í¬ëª¨ë“œì—ì„œ ìŠ¤í¬ë¦° ìº¡ì²˜ ë²„íŠ¼ ìŠ¤íƒ€ì¼ */
    body.dark-mode .screen-capture-btn {
      background: #e67e22;
    }

    body.dark-mode .screen-capture-btn:hover {
      background: #d35400;
    }

    /* í”Œë ˆì´ìŠ¤í™€ë” í…ìŠ¤íŠ¸ ë‹¤í¬ëª¨ë“œ */
    body.dark-mode input::placeholder {
      color: #999 !important;
    }

    body.dark-mode input::-webkit-input-placeholder {
      color: #999 !important;
    }

    body.dark-mode input::-moz-placeholder {
      color: #999 !important;
    }    body.dark-mode input:-ms-input-placeholder {
      color: #999 !important;
    }

    /* ì„¹ì…˜ í—¤ë” ë ˆì´ì•„ì›ƒ ìŠ¤íƒ€ì¼ */
    .section-header-with-button {
      display: flex;
      justify-content: space-between;
      align-items: flex-start;
      gap: 20px;
    }

    .section-header-content {
      flex: 1;
    }

    .section-header-actions {
      flex-shrink: 0;
      display: flex;
      gap: 10px;
      align-items: flex-start;
      margin-top: 5px;
    }

    /* RPA ì‹¤í–‰ ë²„íŠ¼ ìŠ¤íƒ€ì¼ */
    .action-btn {
      display: inline-flex;
      align-items: center;
      gap: 8px;
      padding: 12px 20px;
      border: none;
      border-radius: 6px;
      font-size: 14px;
      font-weight: 500;
      cursor: pointer;
      transition: all 0.3s ease;
      text-decoration: none;
      box-shadow: 0 2px 4px rgba(0,0,0,0.1);
    }

    .process-btn {
      background: linear-gradient(135deg, #27ae60, #2ecc71);
      color: white;
    }

    .process-btn:hover:not(:disabled) {
      background: linear-gradient(135deg, #229954, #27ae60);
      transform: translateY(-1px);
      box-shadow: 0 4px 8px rgba(0,0,0,0.15);
    }

    .process-btn:disabled {
      background: #bdc3c7;
      cursor: not-allowed;
      transform: none;
      box-shadow: 0 1px 2px rgba(0,0,0,0.1);
    }

    .btn-icon {
      font-size: 12px;
    }

    /* ë‹¤í¬ ëª¨ë“œìš© RPA ì‹¤í–‰ ë²„íŠ¼ ìŠ¤íƒ€ì¼ */
    body.dark-mode .process-btn {
      background: linear-gradient(135deg, #1e7e34, #28a745);
    }

    body.dark-mode .process-btn:hover:not(:disabled) {
      background: linear-gradient(135deg, #155724, #1e7e34);
    }

    body.dark-mode .process-btn:disabled {
      background: #495057;
    }
  </style>
</head>
<body>
  <!-- ë¡œê·¸ì¸ ëª¨ë“ˆ ìŠ¤í¬ë¦½íŠ¸ ë¡œë“œ -->
  <script src="login-module.js"></script>  <!-- ì‚¬ì´ë“œë°” ë„¤ë¹„ê²Œì´ì…˜ -->  <div class="sidebar">
    <div class="sidebar-header">
      <img src="ERP_RPAì•„ì´ì½˜.png" alt="ERP RPA" class="sidebar-logo">
    <div class="sidebar-title">ERP RPA SYSTEM - Ark</div>
    <div class="sidebar-subtitle" style="font-size:12px; font-weight:400; margin-top:4px;">
      <span style="color:#2980b9; font-weight:600;">HyperAutomation</span> <span style="opacity:0.7;">| Rev. 2025.06.28</span>
    </div>
    </div>
    <nav class="sidebar-nav">
      <a href="index.html" class="nav-item" id="nav-voucher">
        <span class="nav-icon">ğŸ“‹</span>
        1. íšŒê³„ ì „í‘œ ìƒì‹ 
      </a>
      <a href="index2.html" class="nav-item active" id="nav-invoice">
        <span class="nav-icon">ğŸ“„</span>
        2. ë§¤ì…ì†¡ì¥ ìƒì‹ 
      </a>    </nav>
  </div>

  <!-- ë©”ì¸ ì»¨í…ì¸  -->
  <div class="main-content">
    <!-- ìŠ¤í¬ë¦° ìº¡ì²˜ ë²„íŠ¼ -->
    <button class="screen-capture-btn" onclick="captureFullPage()" title="ì „ì²´ í˜ì´ì§€ ìŠ¤í¬ë¦°ìƒ·">
      <span id="captureIcon">ğŸ“·</span>
    </button>
    
    <!-- ë‹¤í¬ëª¨ë“œ í† ê¸€ ë²„íŠ¼ -->
    <button class="dark-mode-toggle" onclick="toggleDarkMode()" title="ë‹¤í¬ëª¨ë“œ ì „í™˜">
      <span id="darkModeIcon">ğŸŒ™</span>
    </button>
    
    <div class="container"><!-- í˜ì´ì§€ í—¤ë” -->
      <div class="section">
        <h2>ğŸ“„ ë§¤ì…ì†¡ì¥ ì²˜ë¦¬</h2>
        <p>ë§¤ì…ì†¡ì¥ íŒŒì¼ì„ ì—…ë¡œë“œí•˜ê³  ìë™ ì²˜ë¦¬ë¥¼ ì§„í–‰í•©ë‹ˆë‹¤.</p>        <div style="margin-top: 20px;">
          <!-- RPA ì‹¤í–‰ ë²„íŠ¼ -->          <button onclick="executeRPA()" class="action-btn process-btn">
            <span class="btn-icon">ğŸš€</span> RPA ì‹¤í–‰
          </button>
        </div>
      </div>

      <!-- íŒŒì¼ ì—…ë¡œë“œ ì„¹ì…˜ -->
      <div class="section">
        <h3>ğŸ“ íŒŒì¼ ì—…ë¡œë“œ</h3>
        <div class="input-group">
          <h3>ì—…ë¡œë“œ ì„¤ì •</h3>
          <div class="form-row">
            <label for="fileType">íŒŒì¼ í˜•ì‹:</label>
            <select id="fileType">
              <option value="pdf">PDF íŒŒì¼</option>
              <option value="excel">Excel íŒŒì¼</option>
              <option value="image">ì´ë¯¸ì§€ íŒŒì¼</option>
              <option value="all">ëª¨ë“  íŒŒì¼</option>
            </select>
          </div>
          <div class="form-row">
            <label for="processingMode">ì²˜ë¦¬ ëª¨ë“œ:</label>
            <select id="processingMode">
              <option value="auto">ìë™ ì²˜ë¦¬</option>
              <option value="manual">ìˆ˜ë™ ê²€í† </option>
              <option value="batch">ì¼ê´„ ì²˜ë¦¬</option>
            </select>
          </div>
        </div>

        <div class="file-upload-area" id="uploadArea">
          <div class="upload-icon">ğŸ“¤</div>
          <div class="upload-text">íŒŒì¼ì„ ë“œë˜ê·¸í•˜ì—¬ ë†“ê±°ë‚˜ í´ë¦­í•˜ì—¬ ì„ íƒí•˜ì„¸ìš”</div>
          <div class="upload-hint">PDF, Excel, ì´ë¯¸ì§€ íŒŒì¼ì„ ì§€ì›í•©ë‹ˆë‹¤</div>
          <input type="file" id="fileInput" multiple accept=".pdf,.xlsx,.xls,.jpg,.jpeg,.png" style="display: none;">
        </div>

        <div class="file-list" id="fileList">
          <!-- ì—…ë¡œë“œëœ íŒŒì¼ ëª©ë¡ì´ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤ -->
        </div>

        <div class="button-group">
          <button class="btn-primary" onclick="selectFiles()">ğŸ“ íŒŒì¼ ì„ íƒ</button>
          <button class="btn-success" onclick="uploadFiles()" id="uploadBtn" disabled>â¬†ï¸ ì—…ë¡œë“œ ì‹œì‘</button>
          <button class="btn-secondary" onclick="clearFiles()">ğŸ—‘ï¸ ëª©ë¡ ì§€ìš°ê¸°</button>
        </div>
      </div>

      <!-- ì²˜ë¦¬ ì§„í–‰ ìƒí™© -->
      <div class="section">
        <h3>âš™ï¸ ì²˜ë¦¬ ì§„í–‰ ìƒí™©</h3>
        <div class="progress-section">
          <div>ì²˜ë¦¬ ì§„í–‰ë¥ </div>
          <div class="progress-bar">
            <div class="progress-fill" id="progressFill"></div>
          </div>
          <div class="progress-text" id="progressText">ëŒ€ê¸° ì¤‘...</div>
        </div>
      </div>

      <!-- ì²˜ë¦¬ ì˜µì…˜ -->
      <div class="section">
        <h3>âš™ï¸ ì²˜ë¦¬ ì˜µì…˜</h3>
        <div class="input-group">
          <h3>ìë™ ì²˜ë¦¬ ì„¤ì •</h3>
          <div class="form-row">
            <label for="extractData">ë°ì´í„° ì¶”ì¶œ:</label>
            <select id="extractData">
              <option value="all">ëª¨ë“  ì •ë³´</option>
              <option value="essential">í•„ìˆ˜ ì •ë³´ë§Œ</option>
              <option value="custom">ì‚¬ìš©ì ì •ì˜</option>
            </select>
          </div>
          <div class="form-row">
            <label for="validation">ìœ íš¨ì„± ê²€ì‚¬:</label>
            <select id="validation">
              <option value="strict">ì—„ê²©í•¨</option>
              <option value="normal">ë³´í†µ</option>
              <option value="relaxed">ê´€ëŒ€í•¨</option>
            </select>
          </div>
          <div class="form-row">
            <label for="outputFormat">ì¶œë ¥ í˜•ì‹:</label>
            <select id="outputFormat">
              <option value="excel">Excel íŒŒì¼</option>
              <option value="csv">CSV íŒŒì¼</option>
              <option value="json">JSON íŒŒì¼</option>
            </select>
          </div>
        </div>

        <div class="button-group">
          <button class="btn-primary" onclick="startProcessing()">ğŸš€ ì²˜ë¦¬ ì‹œì‘</button>
          <button class="btn-secondary" onclick="pauseProcessing()">â¸ï¸ ì¼ì‹œ ì •ì§€</button>
          <button class="btn-secondary" onclick="stopProcessing()">â¹ï¸ ì¤‘ì§€</button>
        </div>
      </div>

      <!-- ê²°ê³¼ í™•ì¸ -->
      <div class="section">
        <h3>ğŸ“Š ì²˜ë¦¬ ê²°ê³¼</h3>
        <div class="input-group">
          <h3>ì²˜ë¦¬ í†µê³„</h3>
          <div class="form-row">
            <label>ì´ íŒŒì¼ ìˆ˜:</label>
            <span id="totalFiles">0</span>
          </div>
          <div class="form-row">
            <label>ì²˜ë¦¬ ì™„ë£Œ:</label>
            <span id="completedFiles">0</span>
          </div>
          <div class="form-row">
            <label>ì²˜ë¦¬ ì‹¤íŒ¨:</label>
            <span id="failedFiles">0</span>
          </div>
          <div class="form-row">
            <label>ì„±ê³µë¥ :</label>
            <span id="successRate">0%</span>
          </div>
        </div>

        <div class="button-group">
          <button class="btn-success" onclick="downloadResults()">ğŸ“¥ ê²°ê³¼ ë‹¤ìš´ë¡œë“œ</button>
          <button class="btn-primary" onclick="viewResults()">ğŸ‘ï¸ ê²°ê³¼ ë³´ê¸°</button>
          <button class="btn-secondary" onclick="exportReport()">ğŸ“„ ë³´ê³ ì„œ ë‚´ë³´ë‚´ê¸°</button>
        </div>
      </div>
    </div>
  </div>

  <script>
    // íŒŒì¼ ê´€ë¦¬
    let uploadedFiles = [];    // ì „ì²´ í˜ì´ì§€ ìŠ¤í¬ë¦° ìº¡ì²˜ í•¨ìˆ˜
    async function captureFullPage() {
      const captureBtn = document.querySelector('.screen-capture-btn');
      const captureIcon = document.getElementById('captureIcon');
      
      // ë²„íŠ¼ ìƒíƒœ ë³€ê²½
      const originalIcon = captureIcon.textContent;
      captureIcon.textContent = 'â³';
      captureBtn.disabled = true;
      captureBtn.style.opacity = '0.7';
      
      try {
        console.log('ì „ì²´ í˜ì´ì§€ ìŠ¤í¬ë¦° ìº¡ì²˜ ì‹œì‘');
        
        if (window.electronAPI && window.electronAPI.captureFullPage) {
          // Electron í™˜ê²½ì—ì„œ ì‹¤í–‰
          const result = await window.electronAPI.captureFullPage();
          
          if (result.success) {
            // ì„±ê³µ ì‹œ ì ê¹ ì²´í¬ ì•„ì´ì½˜ í‘œì‹œ
            captureIcon.textContent = 'âœ…';
            
            // ìƒì„¸í•œ ì„±ê³µ ë©”ì‹œì§€ í‘œì‹œ
            const message = result.message || 'ì „ì²´ í˜ì´ì§€ ìŠ¤í¬ë¦°ìƒ·ì´ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤!';
            const dimensions = result.dimensions;
            let detailMsg = `${message}\n\nê²½ë¡œ: ${result.path}`;
            
            if (dimensions) {
              detailMsg += `\ní¬ê¸°: ${dimensions.width}x${dimensions.height}px`;
              if (dimensions.steps) {
                detailMsg += `\nìº¡ì²˜ ë‹¨ê³„: ${dimensions.steps}ë‹¨ê³„`;
              }
              if (dimensions.scalingFactor) {
                detailMsg += `\nìŠ¤ì¼€ì¼ë§: ${dimensions.scalingFactor.toFixed(2)}x`;
              }
            }
            
            alert(detailMsg);
            
            setTimeout(() => {
              captureIcon.textContent = originalIcon;
            }, 2000);
          } else {
            captureIcon.textContent = 'âŒ';
            alert('ìŠ¤í¬ë¦°ìƒ· ì €ì¥ ì‹¤íŒ¨: ' + (result.error || 'ì•Œ ìˆ˜ ì—†ëŠ” ì˜¤ë¥˜'));
            setTimeout(() => {
              captureIcon.textContent = originalIcon;
            }, 2000);
          }
        } else if (window.electron && window.electron.ipcRenderer) {
          // í˜¸í™˜ì„±ì„ ìœ„í•œ fallback
          const result = await window.electron.ipcRenderer.invoke('capture-full-page');
          
          if (result.success) {
            captureIcon.textContent = 'âœ…';
            const message = result.message || 'ì „ì²´ í˜ì´ì§€ ìŠ¤í¬ë¦°ìƒ·ì´ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤!';
            alert(`${message}\nê²½ë¡œ: ${result.path}`);
            setTimeout(() => {
              captureIcon.textContent = originalIcon;
            }, 2000);
          } else {
            captureIcon.textContent = 'âŒ';
            alert('ìŠ¤í¬ë¦°ìƒ· ì €ì¥ ì‹¤íŒ¨: ' + (result.error || 'ì•Œ ìˆ˜ ì—†ëŠ” ì˜¤ë¥˜'));
            setTimeout(() => {
              captureIcon.textContent = originalIcon;
            }, 2000);
          }
        } else {
          // ë¸Œë¼ìš°ì € í™˜ê²½ì—ì„œëŠ” html2canvas ì‚¬ìš©
          await captureWithHtml2Canvas();
        }
        
      } catch (error) {
        console.error('ìŠ¤í¬ë¦° ìº¡ì²˜ ì˜¤ë¥˜:', error);
        captureIcon.textContent = 'âŒ';
        alert('ìŠ¤í¬ë¦° ìº¡ì²˜ ì¤‘ ì˜¤ë¥˜ ë°œìƒ: ' + error.message);
        setTimeout(() => {
          captureIcon.textContent = originalIcon;
        }, 2000);
      } finally {
        // ë²„íŠ¼ ìƒíƒœ ë³µì›
        captureBtn.disabled = false;
        captureBtn.style.opacity = '1';
      }
    }// ë¸Œë¼ìš°ì € í™˜ê²½ì—ì„œ html2canvasë¥¼ ì‚¬ìš©í•œ ì „ì²´ í˜ì´ì§€ ìº¡ì²˜
    async function captureWithHtml2Canvas() {
      try {
        // html2canvas ë¼ì´ë¸ŒëŸ¬ë¦¬ê°€ ë¡œë“œë˜ì–´ ìˆëŠ”ì§€ í™•ì¸
        if (typeof html2canvas === 'undefined') {
          // html2canvas ë™ì  ë¡œë“œ
          const script = document.createElement('script');
          script.src = 'https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js';
          document.head.appendChild(script);
          
          await new Promise((resolve, reject) => {
            script.onload = resolve;
            script.onerror = reject;
          });
        }
        
        // í˜„ì¬ ìŠ¤í¬ë¡¤ ìœ„ì¹˜ ì €ì¥
        const originalScrollX = window.scrollX;
        const originalScrollY = window.scrollY;
        
        // í˜ì´ì§€ë¥¼ ë§¨ ìœ„ë¡œ ìŠ¤í¬ë¡¤
        window.scrollTo(0, 0);
        
        // ì „ì²´ í˜ì´ì§€ ìº¡ì²˜ (ìŠ¤í¬ë¡¤ ì˜ì—­ í¬í•¨)
        const canvas = await html2canvas(document.body, {
          height: document.body.scrollHeight,
          width: document.body.scrollWidth,
          useCORS: true,
          scale: 1,
          scrollX: 0,
          scrollY: 0,
          windowWidth: document.body.scrollWidth,
          windowHeight: document.body.scrollHeight
        });
        
        // ì›ë˜ ìŠ¤í¬ë¡¤ ìœ„ì¹˜ë¡œ ë³µì›
        window.scrollTo(originalScrollX, originalScrollY);
        
        // íŒŒì¼ëª… ìƒì„±
        const timestamp = new Date().toISOString().slice(0, 19).replace(/:/g, '-');
        const fileName = `screenshot_${timestamp}.png`;
        
        // ì´ë¯¸ì§€ ë‹¤ìš´ë¡œë“œ
        const link = document.createElement('a');
        link.download = fileName;
        link.href = canvas.toDataURL('image/png');
        link.click();
        
        // ì„±ê³µ ë©”ì‹œì§€
        const captureIcon = document.getElementById('captureIcon');
        captureIcon.textContent = 'âœ…';
        setTimeout(() => {
          captureIcon.textContent = 'ğŸ“·';
        }, 1500);
        
        alert(`ì „ì²´ í˜ì´ì§€ ìŠ¤í¬ë¦°ìƒ·ì´ ë‹¤ìš´ë¡œë“œë˜ì—ˆìŠµë‹ˆë‹¤!\níŒŒì¼ëª…: ${fileName}\ní¬ê¸°: ${canvas.width}x${canvas.height}px`);
        
      } catch (error) {
        throw new Error('ë¸Œë¼ìš°ì € ì „ì²´ í˜ì´ì§€ ìº¡ì²˜ ì‹¤íŒ¨: ' + error.message);
      }
    }

    // ë‹¤í¬ëª¨ë“œ í† ê¸€ í•¨ìˆ˜
    function toggleDarkMode() {
      const body = document.body;
      const darkModeIcon = document.getElementById('darkModeIcon');
      
      body.classList.toggle('dark-mode');
      
      // ì•„ì´ì½˜ ë³€ê²½
      if (body.classList.contains('dark-mode')) {
        darkModeIcon.textContent = 'â˜€ï¸';
        localStorage.setItem('darkMode', 'enabled');
      } else {
        darkModeIcon.textContent = 'ğŸŒ™';
        localStorage.setItem('darkMode', 'disabled');
      }
    }

    // í˜ì´ì§€ ë¡œë“œ ì‹œ ë‹¤í¬ëª¨ë“œ ì„¤ì • ë³µì›
    function initializeDarkMode() {
      const darkMode = localStorage.getItem('darkMode');
      const body = document.body;
      const darkModeIcon = document.getElementById('darkModeIcon');
      
      if (darkMode === 'enabled') {
        body.classList.add('dark-mode');
        darkModeIcon.textContent = 'â˜€ï¸';
      } else {
        darkModeIcon.textContent = 'ğŸŒ™';
      }
    }

    // íŒŒì¼ ì„ íƒ
    function selectFiles() {
      document.getElementById('fileInput').click();
    }

    // íŒŒì¼ ì—…ë¡œë“œ ì˜ì—­ ì´ë²¤íŠ¸
    function setupFileUpload() {
      const uploadArea = document.getElementById('uploadArea');
      const fileInput = document.getElementById('fileInput');

      // ë“œë˜ê·¸ ì•¤ ë“œë¡­ ì´ë²¤íŠ¸
      uploadArea.addEventListener('dragover', (e) => {
        e.preventDefault();
        uploadArea.classList.add('dragover');
      });

      uploadArea.addEventListener('dragleave', () => {
        uploadArea.classList.remove('dragover');
      });

      uploadArea.addEventListener('drop', (e) => {
        e.preventDefault();
        uploadArea.classList.remove('dragover');
        const files = Array.from(e.dataTransfer.files);
        addFiles(files);
      });

      // í´ë¦­ìœ¼ë¡œ íŒŒì¼ ì„ íƒ
      uploadArea.addEventListener('click', () => {
        fileInput.click();
      });

      // íŒŒì¼ ì…ë ¥ ë³€ê²½
      fileInput.addEventListener('change', (e) => {
        const files = Array.from(e.target.files);
        addFiles(files);
      });
    }

    // íŒŒì¼ ì¶”ê°€
    function addFiles(files) {
      files.forEach(file => {
        if (!uploadedFiles.find(f => f.name === file.name)) {
          uploadedFiles.push({
            file: file,
            name: file.name,
            size: file.size,
            status: 'pending'
          });
        }
      });
      updateFileList();
      updateUploadButton();
    }

    // íŒŒì¼ ëª©ë¡ ì—…ë°ì´íŠ¸
    function updateFileList() {
      const fileList = document.getElementById('fileList');
      fileList.innerHTML = '';

      uploadedFiles.forEach((fileItem, index) => {
        const fileDiv = document.createElement('div');
        fileDiv.className = 'file-item';
        fileDiv.innerHTML = `
          <div class="file-info">
            <span class="file-icon">ğŸ“„</span>
            <div>
              <div class="file-name">${fileItem.name}</div>
              <div class="file-size">${formatFileSize(fileItem.size)}</div>
            </div>
          </div>
          <div class="file-actions">
            <span class="status-indicator status-${fileItem.status}">${getStatusText(fileItem.status)}</span>
            <button class="btn-remove" onclick="removeFile(${index})">ì‚­ì œ</button>
          </div>
        `;
        fileList.appendChild(fileDiv);
      });
    }

    // íŒŒì¼ ì œê±°
    function removeFile(index) {
      uploadedFiles.splice(index, 1);
      updateFileList();
      updateUploadButton();
    }

    // ëª¨ë“  íŒŒì¼ ì§€ìš°ê¸°
    function clearFiles() {
      uploadedFiles = [];
      updateFileList();
      updateUploadButton();
    }

    // ì—…ë¡œë“œ ë²„íŠ¼ ìƒíƒœ ì—…ë°ì´íŠ¸
    function updateUploadButton() {
      const uploadBtn = document.getElementById('uploadBtn');
      uploadBtn.disabled = uploadedFiles.length === 0;
    }

    // íŒŒì¼ í¬ê¸° í¬ë§·
    function formatFileSize(bytes) {
      if (bytes === 0) return '0 Bytes';
      const k = 1024;
      const sizes = ['Bytes', 'KB', 'MB', 'GB'];
      const i = Math.floor(Math.log(bytes) / Math.log(k));
      return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + ' ' + sizes[i];
    }

    // ìƒíƒœ í…ìŠ¤íŠ¸ ë°˜í™˜
    function getStatusText(status) {
      const statusMap = {
        'pending': 'ëŒ€ê¸°',
        'processing': 'ì²˜ë¦¬ì¤‘',
        'completed': 'ì™„ë£Œ',
        'error': 'ì˜¤ë¥˜'
      };
      return statusMap[status] || 'ì•Œ ìˆ˜ ì—†ìŒ';
    }    // íŒŒì¼ ì—…ë¡œë“œ ì‹œì‘
    function uploadFiles() {
      // ë¡œê·¸ì¸ ìƒíƒœ í™•ì¸
      if (!isLoggedIn()) {
        alert('ë¡œê·¸ì¸ì´ í•„ìš”í•©ë‹ˆë‹¤.');
        return;
      }

      if (uploadedFiles.length === 0) return;

      uploadedFiles.forEach(fileItem => {
        fileItem.status = 'processing';
      });
      updateFileList();

      // ì‹œë®¬ë ˆì´ì…˜ëœ ì—…ë¡œë“œ í”„ë¡œì„¸ìŠ¤
      setTimeout(() => {
        uploadedFiles.forEach(fileItem => {
          fileItem.status = Math.random() > 0.2 ? 'completed' : 'error';
        });
        updateFileList();
        updateStatistics();
      }, 3000);
    }    // ì²˜ë¦¬ ì‹œì‘
    function startProcessing() {
      // ë¡œê·¸ì¸ ìƒíƒœ í™•ì¸
      if (!isLoggedIn()) {
        alert('ë¡œê·¸ì¸ì´ í•„ìš”í•©ë‹ˆë‹¤.');
        return;
      }

      const progressFill = document.getElementById('progressFill');
      const progressText = document.getElementById('progressText');
      
      progressText.textContent = 'ì²˜ë¦¬ ì¤‘...';
      
      let progress = 0;
      const interval = setInterval(() => {
        progress += Math.random() * 10;
        if (progress >= 100) {
          progress = 100;
          clearInterval(interval);
          progressText.textContent = 'ì²˜ë¦¬ ì™„ë£Œ';
        }
        progressFill.style.width = progress + '%';
      }, 500);
    }

    // ì²˜ë¦¬ ì¼ì‹œ ì •ì§€
    function pauseProcessing() {
      const progressText = document.getElementById('progressText');
      progressText.textContent = 'ì¼ì‹œ ì •ì§€ë¨';
    }

    // ì²˜ë¦¬ ì¤‘ì§€
    function stopProcessing() {
      const progressFill = document.getElementById('progressFill');
      const progressText = document.getElementById('progressText');
      progressFill.style.width = '0%';
      progressText.textContent = 'ì¤‘ì§€ë¨';
    }

    // í†µê³„ ì—…ë°ì´íŠ¸
    function updateStatistics() {
      const total = uploadedFiles.length;
      const completed = uploadedFiles.filter(f => f.status === 'completed').length;
      const failed = uploadedFiles.filter(f => f.status === 'error').length;
      const successRate = total > 0 ? Math.round((completed / total) * 100) : 0;

      document.getElementById('totalFiles').textContent = total;
      document.getElementById('completedFiles').textContent = completed;
      document.getElementById('failedFiles').textContent = failed;
      document.getElementById('successRate').textContent = successRate + '%';
    }    // ê²°ê³¼ ë‹¤ìš´ë¡œë“œ
    function downloadResults() {
      // ë¡œê·¸ì¸ ìƒíƒœ í™•ì¸
      if (!isLoggedIn()) {
        alert('ë¡œê·¸ì¸ì´ í•„ìš”í•©ë‹ˆë‹¤.');
        return;
      }
      alert('ê²°ê³¼ íŒŒì¼ì„ ë‹¤ìš´ë¡œë“œí•©ë‹ˆë‹¤.');
    }

    // ê²°ê³¼ ë³´ê¸°
    function viewResults() {
      // ë¡œê·¸ì¸ ìƒíƒœ í™•ì¸
      if (!isLoggedIn()) {
        alert('ë¡œê·¸ì¸ì´ í•„ìš”í•©ë‹ˆë‹¤.');
        return;
      }
      alert('ì²˜ë¦¬ ê²°ê³¼ë¥¼ í™•ì¸í•©ë‹ˆë‹¤.');
    }

    // ë³´ê³ ì„œ ë‚´ë³´ë‚´ê¸°
    function exportReport() {
      // ë¡œê·¸ì¸ ìƒíƒœ í™•ì¸
      if (!isLoggedIn()) {
        alert('ë¡œê·¸ì¸ì´ í•„ìš”í•©ë‹ˆë‹¤.');
        return;
      }
      alert('ì²˜ë¦¬ ë³´ê³ ì„œë¥¼ ë‚´ë³´ëƒ…ë‹ˆë‹¤.');
    }    // ë²„íŠ¼ ìƒíƒœ ì—…ë°ì´íŠ¸ í•¨ìˆ˜ (ë¡œê·¸ì¸ ìƒíƒœì— ë”°ë¼)
    function updateButtonStates() {
      const buttons = document.querySelectorAll('.btn-primary, .btn-success, .btn-secondary, .process-btn');
      const isUserLoggedIn = isLoggedIn();
      
      console.log('updateButtonStates í˜¸ì¶œë¨. ë¡œê·¸ì¸ ìƒíƒœ:', isUserLoggedIn);
      
      // ì§„í–‰ ë²„íŠ¼ íŠ¹ë³„ ì²˜ë¦¬
      const processInvoiceBtn = document.getElementById('processInvoiceBtn');
      if (processInvoiceBtn) {
        console.log('processInvoiceBtn ìƒíƒœ ì—…ë°ì´íŠ¸:', isUserLoggedIn);
        processInvoiceBtn.disabled = !isUserLoggedIn;
        if (!isUserLoggedIn) {
          processInvoiceBtn.style.opacity = '0.5';
          processInvoiceBtn.title = 'ë¡œê·¸ì¸ì´ í•„ìš”í•©ë‹ˆë‹¤';
        } else {
          processInvoiceBtn.style.opacity = '1';
          processInvoiceBtn.title = '';
        }
      }
      
      // ë‹¤ë¥¸ ë²„íŠ¼ë“¤ ì²˜ë¦¬
      buttons.forEach(button => {
        if (button.id !== 'processInvoiceBtn') { // ì´ë¯¸ ì²˜ë¦¬ëœ ë²„íŠ¼ ì œì™¸
          const shouldUpdate = (
            (button.onclick && (
              button.onclick.toString().includes('uploadFiles') ||
              button.onclick.toString().includes('startProcessing') ||
              button.onclick.toString().includes('downloadResults') ||
              button.onclick.toString().includes('viewResults') ||
              button.onclick.toString().includes('exportReport')
            ))
          );
          
          if (shouldUpdate) {
            console.log('ë²„íŠ¼ ì—…ë°ì´íŠ¸:', button.id || button.className, 'ë¡œê·¸ì¸ ìƒíƒœ:', isUserLoggedIn);
            button.disabled = !isUserLoggedIn;
            if (!isUserLoggedIn) {
              button.style.opacity = '0.5';
              button.title = 'ë¡œê·¸ì¸ì´ í•„ìš”í•©ë‹ˆë‹¤';
            } else {
              button.style.opacity = '1';
              button.title = '';
            }
          }
        }
      });    }    // RPA ì‹¤í–‰ í•¨ìˆ˜
    async function executeRPA() {
      console.log('=== RPA ì‹¤í–‰ ì‹œì‘ ===');
      console.log('executeRPA í•¨ìˆ˜ê°€ í˜¸ì¶œë˜ì—ˆìŠµë‹ˆë‹¤!');
      
      // ë¡œê·¸ì¸ ìƒíƒœ í™•ì¸ (ì—¬ëŸ¬ ë°©ë²•ìœ¼ë¡œ ì‹œë„)
      let loginStatus = false;
      
      if (typeof window.isLoggedIn === 'function') {
        loginStatus = window.isLoggedIn();
        console.log('window.isLoggedIn():', loginStatus);
      } else if (typeof isLoggedIn === 'function') {
        loginStatus = isLoggedIn();
        console.log('isLoggedIn():', loginStatus);
      } else {
        console.error('isLoggedIn í•¨ìˆ˜ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤!');
        alert('ë¡œê·¸ì¸ ì‹œìŠ¤í…œ ì˜¤ë¥˜: ë¡œê·¸ì¸ í•¨ìˆ˜ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.\ní˜ì´ì§€ë¥¼ ìƒˆë¡œê³ ì¹¨í•´ì£¼ì„¸ìš”.');
        return;
      }
      
      if (!loginStatus) {
        console.log('ë¡œê·¸ì¸ë˜ì§€ ì•ŠìŒ - ë¡œê·¸ì¸ ì˜¤ë²„ë ˆì´ í‘œì‹œ');
        
        if (typeof showNotification === 'function') {
          showNotification('ë¨¼ì € ë¡œê·¸ì¸ì„ í•´ì£¼ì„¸ìš”.', 'warning');
        } else {
          alert('ë¨¼ì € ë¡œê·¸ì¸ì„ í•´ì£¼ì„¸ìš”.');
        }
        
        if (typeof showLoginOverlay === 'function') {
          showLoginOverlay();
        } else if (typeof window.showLoginOverlay === 'function') {
          window.showLoginOverlay();
        } else {
          console.warn('showLoginOverlay í•¨ìˆ˜ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
        }
        return;
      }

      // RPA ì‹¤í–‰ ë²„íŠ¼ ì°¾ê¸°
      const rpaBtn = document.querySelector('button[onclick="executeRPA()"]');
      const originalHTML = rpaBtn ? rpaBtn.innerHTML : '';
      
      try {
        // ë²„íŠ¼ ìƒíƒœ ë³€ê²½
        if (rpaBtn) {
          console.log('ë²„íŠ¼ ìƒíƒœ ë³€ê²½ ì¤‘...');
          rpaBtn.disabled = true;
          rpaBtn.innerHTML = '<span class="btn-icon">â³</span> ì²˜ë¦¬ ì¤‘...';
        }
        
        console.log('ë§¤ì…ì†¡ì¥ RPA ì²˜ë¦¬ ì‹œì‘...');
        
        if (typeof showNotification === 'function') {
          showNotification('ë§¤ì…ì†¡ì¥ RPA ì²˜ë¦¬ë¥¼ ì‹œì‘í•©ë‹ˆë‹¤...', 'info');
        } else {
          alert('ë§¤ì…ì†¡ì¥ RPA ì²˜ë¦¬ë¥¼ ì‹œì‘í•©ë‹ˆë‹¤...');
        }
        
        // API í™•ì¸ ë° í˜¸ì¶œ
        console.log('window.electronAPI í™•ì¸:', !!window.electronAPI);
        console.log('processInvoice API í™•ì¸:', !!window.electronAPI?.processInvoice);
        
        if (window.electronAPI && window.electronAPI.processInvoice) {
          console.log('Electron API í˜¸ì¶œ ì¤‘...');
          const result = await window.electronAPI.processInvoice();
          console.log('RPA ì²˜ë¦¬ ê²°ê³¼:', result);
          
          if (result.success) {
            const message = result.message || 'RPA ì²˜ë¦¬ê°€ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤.';
            if (typeof showNotification === 'function') {
              showNotification(message, 'success');
            } else {
              alert('ì„±ê³µ: ' + message);
            }
          } else {
            const error = result.error || 'RPA ì²˜ë¦¬ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.';
            if (typeof showNotification === 'function') {
              showNotification(error, 'error');
            } else {
              alert('ì˜¤ë¥˜: ' + error);
            }
          }
        } else {
          const errorMsg = 'Electron APIê°€ ì—°ê²°ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.';
          console.error(errorMsg);
          if (typeof showNotification === 'function') {
            showNotification(errorMsg, 'error');
          } else {
            alert('ì˜¤ë¥˜: ' + errorMsg);
          }
        }
        
      } catch (error) {
        console.error('RPA ì‹¤í–‰ ì˜¤ë¥˜:', error);
        const errorMsg = 'RPA ì‹¤í–‰ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤: ' + error.message;
        if (typeof showNotification === 'function') {
          showNotification(errorMsg, 'error');
        } else {
          alert(errorMsg);
        }
      } finally {
        // ë²„íŠ¼ ìƒíƒœ ë³µì›
        console.log('ë²„íŠ¼ ìƒíƒœ ë³µì› ì¤‘...');
        if (rpaBtn) {
          rpaBtn.disabled = false;
          rpaBtn.innerHTML = originalHTML || '<span class="btn-icon">ğŸš€</span> RPA ì‹¤í–‰';
        }
      }
    }      // í˜ì´ì§€ ë¡œë“œ ì™„ë£Œ ì‹œ ì´ˆê¸°í™”
    document.addEventListener('DOMContentLoaded', function() {
      console.log('=== DOMContentLoaded ì´ë²¤íŠ¸ ë°œìƒ ===');
      console.log('ì‚¬ìš© ê°€ëŠ¥í•œ í•¨ìˆ˜ë“¤ í™•ì¸:');
      console.log('- window.isLoggedIn:', typeof window.isLoggedIn);
      console.log('- isLoggedIn:', typeof isLoggedIn);
      console.log('- showNotification:', typeof showNotification);
      console.log('- showLoginOverlay:', typeof showLoginOverlay);
      console.log('- window.electronAPI:', !!window.electronAPI);
      console.log('- window.electronAPI.processInvoice:', !!window.electronAPI?.processInvoice);
      console.log('DOMContentLoaded ì´ë²¤íŠ¸ ë°œìƒ');
      
      // ë¡œê·¸ì¸ ì‹œìŠ¤í…œ ì´ˆê¸°í™”
      initializeLoginSystem();
      
      initializeDarkMode();
      setupFileUpload();
      updateStatistics();
        // ë²„íŠ¼ ìƒíƒœ ì´ˆê¸°í™”      updateButtonStates();
    });

    // ì „ì—­ì—ì„œ ì ‘ê·¼ ê°€ëŠ¥í•˜ë„ë¡ window ê°ì²´ì— í• ë‹¹
    window.captureFullPage = captureFullPage;
    window.toggleDarkMode = toggleDarkMode;
  </script>
</body>
</html>
